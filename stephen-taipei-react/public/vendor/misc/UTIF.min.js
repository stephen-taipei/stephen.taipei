/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/utif@3.1.0/UTIF.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(){var e={};function r(){"undefined"!=typeof process&&"development"!=process.env.NODE_ENV||console.log.apply(console,arguments)}"object"==typeof module?module.exports=e:self.UTIF=e,function(e,t){var n,i,o;n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e){this.message="JPEG error: "+e}return e.prototype=Error(),e.prototype.name="JpegError",e.constructor=e}(),o=function(){function e(e,r){this.message=e,this.g=r}return e.prototype=Error(),e.prototype.name="DNLMarkerError",e.constructor=e}(),function(){function r(){this.M=null,this.B=-1}function t(e,r){for(var t,n,i=0,o=[],a=16;0<a&&!e[a-1];)a--;o.push({children:[],index:0});var f,s=o[0];for(t=0;t<a;t++){for(n=0;n<e[t];n++){for((s=o.pop()).children[s.index]=r[i];0<s.index;)s=o.pop();for(s.index++,o.push(s);o.length<=t;)o.push(f={children:[],index:0}),s.children[s.index]=f.children,s=f;i++}t+1<a&&(o.push(f={children:[],index:0}),s.children[s.index]=f.children,s=f)}return o[0].children}function a(e,r,t,a,f,d,u,c,l){function v(){if(0<M)return M--,k>>M&1;if(255===(k=e[r++])){var n=e[r++];if(n){if(220===n&&A){r+=2;var a=e[r++]<<8|e[r++];if(0<a&&a!==t.g)throw new o("Found DNL marker (0xFFDC) while parsing scan data",a)}throw new i("unexpected marker "+(k<<8|n).toString(16))}}return M=7,k>>>7}function g(e){for(;;){if("number"==typeof(e=e[v()]))return e;if("object"!==(void 0===e?"undefined":n(e)))throw new i("invalid huffman sequence")}}function w(e){for(var r=0;0<e;)r=r<<1|v(),e--;return r}function _(e){if(1===e)return 1===v()?1:-1;var r=w(e);return r>=1<<e-1?r:r+(-1<<e)+1}for(var p,b,m,y,U,E,I,A=9<arguments.length&&void 0!==arguments[9]&&arguments[9],B=t.P,D=r,k=0,M=0,F=0,G=0,N=a.length,S=t.S?0===d?0===c?function(e,r){var t=g(e.D);t=0===t?0:_(t)<<l,e.a[r]=e.m+=t}:function(e,r){e.a[r]|=v()<<l}:0===c?function(e,r){if(0<F)F--;else for(var t=d;t<=u;){var n=g(e.o),i=15&n;if(n>>=4,0===i){if(15>n){F=w(n)+(1<<n)-1;break}t+=16}else t+=n,e.a[r+h[t]]=_(i)*(1<<l),t++}}:function(e,r){for(var t,n=d,o=0;n<=u;){t=r+h[n];var a=0>e.a[t]?-1:1;switch(G){case 0:if(t=15&(o=g(e.o)),o>>=4,0===t)15>o?(F=w(o)+(1<<o),G=4):(o=16,G=1);else{if(1!==t)throw new i("invalid ACn encoding");p=_(t),G=o?2:3}continue;case 1:case 2:e.a[t]?e.a[t]+=a*(v()<<l):0==--o&&(G=2===G?3:0);break;case 3:e.a[t]?e.a[t]+=a*(v()<<l):(e.a[t]=p<<l,G=0);break;case 4:e.a[t]&&(e.a[t]+=a*(v()<<l))}n++}4===G&&0==--F&&(G=0)}:function(e,r){var t=g(e.D);for(t=0===t?0:_(t),e.a[r]=e.m+=t,t=1;64>t;){var n=g(e.o),i=15&n;if(n>>=4,0===i){if(15>n)break;t+=16}else t+=n,e.a[r+h[t]]=_(i),t++}},P=0,L=1===N?a[0].c*a[0].l:B*t.O;P<L;){var x=f?Math.min(L-P,f):L;for(b=0;b<N;b++)a[b].m=0;if(F=0,1===N){var J=a[0];for(U=0;U<x;U++)S(J,64*((J.c+1)*(P/J.c|0)+P%J.c)),P++}else for(U=0;U<x;U++){for(b=0;b<N;b++)for(E=(J=a[b]).h,I=J.j,m=0;m<I;m++)for(y=0;y<E;y++)S(J,64*((J.c+1)*((P/B|0)*J.j+m)+(P%B*J.h+y)));P++}if(M=0,(J=s(e,r))&&J.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+J.f),r=J.offset),!(J=J&&J.F)||65280>=J)throw new i("marker was not found");if(!(65488<=J&&65495>=J))break;r+=2}return(J=s(e,r))&&J.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+J.f),r=J.offset),r-D}function f(e,r){for(var t=r.c,n=r.l,o=new Int16Array(64),a=0;a<n;a++)for(var f=0;f<t;f++){var s=64*((r.c+1)*a+f),h=o,d=r.G,u=r.a;if(!d)throw new i("missing required Quantization Table.");for(var c=0;64>c;c+=8){var l=u[s+c],v=u[s+c+1],g=u[s+c+2],w=u[s+c+3],_=u[s+c+4],p=u[s+c+5],b=u[s+c+6],m=u[s+c+7];if(l*=d[c],v|g|w|_|p|b|m){v*=d[c+1],g*=d[c+2],w*=d[c+3],_*=d[c+4],p*=d[c+5];var y=5793*l+128>>8,U=5793*_+128>>8,E=g,I=b*=d[c+6];U=(y=y+U+1>>1)-U,l=3784*E+1567*I+128>>8,E=1567*E-3784*I+128>>8,p=(_=(_=2896*(v-(m*=d[c+7]))+128>>8)+(p<<=4)+1>>1)-p,w=(m=(m=2896*(v+m)+128>>8)+(w<<=4)+1>>1)-w,I=(y=y+(I=l)+1>>1)-I,E=(U=U+E+1>>1)-E,l=2276*_+3406*m+2048>>12,_=3406*_-2276*m+2048>>12,m=l,l=799*w+4017*p+2048>>12,w=4017*w-799*p+2048>>12,p=l,h[c]=y+m,h[c+7]=y-m,h[c+1]=U+p,h[c+6]=U-p,h[c+2]=E+w,h[c+5]=E-w,h[c+3]=I+_,h[c+4]=I-_}else l=5793*l+512>>10,h[c]=l,h[c+1]=l,h[c+2]=l,h[c+3]=l,h[c+4]=l,h[c+5]=l,h[c+6]=l,h[c+7]=l}for(d=0;8>d;++d)l=h[d],(v=h[d+8])|(g=h[d+16])|(w=h[d+24])|(_=h[d+32])|(p=h[d+40])|(b=h[d+48])|(m=h[d+56])?(y=5793*l+2048>>12,U=5793*_+2048>>12,l=3784*(E=g)+1567*(I=b)+2048>>12,E=1567*E-3784*I+2048>>12,I=l,p=(_=(_=2896*(v-m)+2048>>12)+p+1>>1)-p,w=(m=(m=2896*(v+m)+2048>>12)+w+1>>1)-w,l=2276*_+3406*m+2048>>12,_=3406*_-2276*m+2048>>12,m=l,l=799*w+4017*p+2048>>12,w=4017*w-799*p+2048>>12,v=(U=(U=(y=4112+(y+U+1>>1))-U)+E+1>>1)+(p=l),b=U-p,p=(E=U-E)-w,l=16>(l=(y=y+I+1>>1)+m)?0:4080<=l?255:l>>4,v=16>v?0:4080<=v?255:v>>4,g=16>(g=E+w)?0:4080<=g?255:g>>4,w=16>(w=(I=y-I)+_)?0:4080<=w?255:w>>4,_=16>(_=I-_)?0:4080<=_?255:_>>4,p=16>p?0:4080<=p?255:p>>4,b=16>b?0:4080<=b?255:b>>4,m=16>(m=y-m)?0:4080<=m?255:m>>4,u[s+d]=l,u[s+d+8]=v,u[s+d+16]=g,u[s+d+24]=w,u[s+d+32]=_,u[s+d+40]=p,u[s+d+48]=b,u[s+d+56]=m):(l=-2040>(l=5793*l+8192>>14)?0:2024<=l?255:l+2056>>4,u[s+d]=l,u[s+d+8]=l,u[s+d+16]=l,u[s+d+24]=l,u[s+d+32]=l,u[s+d+40]=l,u[s+d+48]=l,u[s+d+56]=l)}return r.a}function s(e,r){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r,n=e.length-1;if(t=t<r?t:r,r>=n)return null;var i=e[r]<<8|e[r+1];if(65472<=i&&65534>=i)return{f:null,F:i,offset:r};for(var o=e[t]<<8|e[t+1];!(65472<=o&&65534>=o);){if(++t>=n)return null;o=e[t]<<8|e[t+1]}return{f:i.toString(16),F:o,offset:t}}var h=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);r.prototype={parse:function(e){function r(){var r=e[l]<<8|e[l+1];return l+=2,r}function n(){var t=r(),n=s(e,t=l+t-2,l);return n&&n.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+n.f),t=n.offset),t=e.subarray(l,t),l+=t.length,t}function d(e){for(var r=Math.ceil(e.v/8/e.s),t=Math.ceil(e.g/8/e.u),n=0;n<e.b.length;n++){D=e.b[n];var i=Math.ceil(Math.ceil(e.v/8)*D.h/e.s),o=Math.ceil(Math.ceil(e.g/8)*D.j/e.u);D.a=new Int16Array(64*t*D.j*(r*D.h+1)),D.c=i,D.l=o}e.P=r,e.O=t}var u=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).N,c=void 0===u?null:u,l=0,v=null,g=0;u=[];var w=[],_=[],p=r();if(65496!==p)throw new i("SOI not found");for(p=r();65497!==p;){switch(p){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var b=n();65518===p&&65===b[0]&&100===b[1]&&111===b[2]&&98===b[3]&&101===b[4]&&(v={version:b[5]<<8|b[6],Y:b[7]<<8|b[8],Z:b[9]<<8|b[10],W:b[11]});break;case 65499:p=r()+l-2;for(var m;l<p;){var y=e[l++],U=new Uint16Array(64);if(y>>4){if(1!=y>>4)throw new i("DQT - invalid table spec");for(b=0;64>b;b++)U[m=h[b]]=r()}else for(b=0;64>b;b++)U[m=h[b]]=e[l++];u[15&y]=U}break;case 65472:case 65473:case 65474:if(E)throw new i("Only single frame JPEGs supported");r();var E={};for(E.X=65473===p,E.S=65474===p,E.precision=e[l++],p=r(),E.g=c||p,E.v=r(),E.b=[],E.C={},b=e[l++],p=U=y=0;p<b;p++){m=e[l];var I=e[l+1]>>4,A=15&e[l+1];y<I&&(y=I),U<A&&(U=A),I=E.b.push({h:I,j:A,T:e[l+2],G:null}),E.C[m]=I-1,l+=3}E.s=y,E.u=U,d(E);break;case 65476:for(m=r(),p=2;p<m;){for(y=e[l++],U=new Uint8Array(16),b=I=0;16>b;b++,l++)I+=U[b]=e[l];for(A=new Uint8Array(I),b=0;b<I;b++,l++)A[b]=e[l];p+=17+I,(y>>4?w:_)[15&y]=t(U,A)}break;case 65501:r();var B=r();break;case 65498:for(b=1==++g&&!c,r(),y=e[l++],m=[],p=0;p<y;p++){U=E.C[e[l++]];var D=E.b[U];U=e[l++],D.D=_[U>>4],D.o=w[15&U],m.push(D)}p=e[l++],y=e[l++],U=e[l++];try{var k=a(e,l,E,m,B,p,y,U>>4,15&U,b);l+=k}catch(r){if(r instanceof o)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(e,{N:r.g});throw r}break;case 65500:l+=4;break;case 65535:255!==e[l]&&l--;break;default:if(255===e[l-3]&&192<=e[l-2]&&254>=e[l-2])l-=3;else{if(!(b=s(e,l-2))||!b.f)throw new i("unknown marker "+p.toString(16));(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+b.f),l=b.offset}}p=r()}for(this.width=E.v,this.height=E.g,this.A=v,this.b=[],p=0;p<E.b.length;p++)(B=u[(D=E.b[p]).T])&&(D.G=B),this.b.push({R:f(0,D),U:D.h/E.s,V:D.j/E.u,c:D.c,l:D.l});this.i=this.b.length},L:function(e,r){var t,n,i=this.width/e,o=this.height/r,a=this.b.length,f=e*r*a,s=new Uint8ClampedArray(f),h=new Uint32Array(e);for(n=0;n<a;n++){var d=this.b[n],u=d.U*i,c=d.V*o,l=n,v=d.R,g=d.c+1<<3;for(t=0;t<e;t++)d=0|t*u,h[t]=(4294967288&d)<<3|7&d;for(u=0;u<r;u++)for(d=g*(4294967288&(d=0|u*c))|(7&d)<<3,t=0;t<e;t++)s[l]=v[d+h[t]],l+=a}if(o=this.M)for(n=0;n<f;)for(i=d=0;d<a;d++,n++,i+=2)s[n]=(s[n]*o[i]>>8)+o[i+1];return s},w:function(){return this.A?!!this.A.W:3===this.i?0!==this.B:1===this.B},I:function(e){for(var r,t,n,i=0,o=e.length;i<o;i+=3)r=e[i],t=e[i+1],n=e[i+2],e[i]=r-179.456+1.402*n,e[i+1]=r+135.459-.344*t-.714*n,e[i+2]=r-226.816+1.772*t;return e},K:function(e){for(var r,t,n,i,o=0,a=0,f=e.length;a<f;a+=4)r=e[a],t=e[a+1],n=e[a+2],i=e[a+3],e[o++]=t*(-660635669420364e-19*t+.000437130475926232*n-54080610064599e-18*r+.00048449797120281*i-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*r-.00477271405408747*i+1.53380253221734)+r*(.000961250184130688*r-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),e[o++]=107.268039397724+t*(219927104525741e-19*t-.000640992018297945*n+.000659397001245577*r+.000426105652938837*i-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*r+.000770482631801132*i-.151051492775562)+r*(.00126935368114843*r-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),e[o++]=t*(-.000570115196973677*t-263409051004589e-19*n+.0020741088115012*r-.00288260236853442*i+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*r+.000560833691242812*i-.195152027534049)+r*(.00174418132927582*r-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return e.subarray(0,o)},J:function(e){for(var r,t,n,i=0,o=e.length;i<o;i+=4)r=e[i],t=e[i+1],n=e[i+2],e[i]=434.456-r-1.402*n,e[i+1]=119.541-r+.344*t+.714*n,e[i+2]=481.816-r-1.772*t;return e},H:function(e){for(var r,t,n,i,o=0,a=1/255,f=0,s=e.length;f<s;f+=4)r=e[f]*a,t=e[f+1]*a,n=e[f+2]*a,i=e[f+3]*a,e[o++]=255+r*(-4.387332384609988*r+54.48615194189176*t+18.82290502165302*n+212.25662451639585*i-285.2331026137004)+t*(1.7149763477362134*t-5.6096736904047315*n-17.873870861415444*i-5.497006427196366)+n*(-2.5217340131683033*n-21.248923337353073*i+17.5119270841813)-i*(21.86122147463605*i+189.48180835922747),e[o++]=255+r*(8.841041422036149*r+60.118027045597366*t+6.871425592049007*n+31.159100130055922*i-79.2970844816548)+t*(-15.310361306967817*t+17.575251261109482*n+131.35250912493976*i-190.9453302588951)+n*(4.444339102852739*n+9.8632861493405*i-24.86741582555878)-i*(20.737325471181034*i+187.80453709719578),e[o++]=255+r*(.8842522430003296*r+8.078677503112928*t+30.89978309703729*n-.23883238689178934*i-14.183576799673286)+t*(10.49593273432072*t+63.02378494754052*n+50.606957656360734*i-112.23884253719248)+n*(.03296041114873217*n+115.60384449646641*i-193.58209356861505)-i*(22.33816807309886*i+180.12613974708367);return e.subarray(0,o)},getData:function(e,r,t){if(4<this.i)throw new i("Unsupported color mode");if(e=this.L(e,r),1===this.i&&t){t=e.length,r=new Uint8ClampedArray(3*t);for(var n=0,o=0;o<t;o++){var a=e[o];r[n++]=a,r[n++]=a,r[n++]=a}return r}if(3===this.i&&this.w())return this.I(e);if(4===this.i){if(this.w())return t?this.K(e):this.J(e);if(t)return this.H(e)}return e}},e.JpegDecoder=r}(),e.encodeImage=function(r,t,n,i){var o={t256:[t],t257:[n],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[n],t279:[t*n*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(i)for(var a in i)o[a]=i[a];var f=new Uint8Array(e.encode([o])),s=new Uint8Array(r),h=new Uint8Array(1e3+t*n*4);for(a=0;a<f.length;a++)h[a]=f[a];for(a=0;a<s.length;a++)h[1e3+a]=s[a];return h.buffer},e.encode=function(r){var t=new Uint8Array(2e4),n=4,i=e._binBE;t[0]=77,t[1]=77,t[3]=42;var o=8;i.writeUint(t,n,o),n+=4;for(var a=0;a<r.length;a++){var f=e._writeIFD(i,t,o,r[a]);o=f[1],a<r.length-1&&i.writeUint(t,f[0],o)}return t.slice(0,o).buffer},e.decode=function(r){e.decode._decodeG3.allow2D=null;var t=new Uint8Array(r),n=0,i=e._binBE.readASCII(t,n,2);n+=2;var o="II"==i?e._binLE:e._binBE;o.readUshort(t,n);n+=2;var a=o.readUint(t,n);n+=4;for(var f=[];;){var s=e._readIFD(o,t,a,f,0,!1);if(0==(a=o.readUint(t,s)))break}return f},e.decodeImage=function(t,n,i){var o=new Uint8Array(t),a=e._binBE.readASCII(o,0,2);if(null!=n.t256){n.isLE="II"==a,n.width=n.t256[0],n.height=n.t257[0];var f,s=n.t259?n.t259[0]:1,h=n.t266?n.t266[0]:1;n.t284&&2==n.t284[0]&&r("PlanarConfiguration 2 should not be used!"),f=n.t258?Math.min(32,n.t258[0])*n.t258.length:n.t277?n.t277[0]:1,1==s&&null!=n.t279&&n.t278&&32803==n.t262[0]&&(f=Math.round(8*n.t279[0]/(n.width*n.t278[0])));var d=8*Math.ceil(n.width*f/8),u=n.t273;null==u&&(u=n.t324);var c=n.t279;1==s&&1==u.length&&(c=[n.height*(d>>>3)]),null==c&&(c=n.t325);var l=new Uint8Array(n.height*(d>>>3)),v=0;if(null!=n.t322){for(var g=n.t322[0],w=n.t323[0],_=Math.floor((n.width+g-1)/g),p=Math.floor((n.height+w-1)/w),b=new Uint8Array(0|Math.ceil(g*w*f/8)),m=0;m<p;m++)for(var y=0;y<_;y++){for(var U=m*_+y,E=0;E<b.length;E++)b[E]=0;e.decode._decompress(n,i,o,u[U],c[U],s,b,0,h),6==s?l=b:e._copyTile(b,0|Math.ceil(g*f/8),w,l,0|Math.ceil(n.width*f/8),n.height,0|Math.ceil(y*g*f/8),m*w)}v=8*l.length}else{var I=n.t278?n.t278[0]:n.height;I=Math.min(I,n.height);for(U=0;U<u.length;U++)e.decode._decompress(n,i,o,u[U],c[U],s,l,0|Math.ceil(v/8),h),v+=d*I;v=Math.min(v,8*l.length)}n.data=new Uint8Array(l.buffer,0,0|Math.ceil(v/8))}},e.decode._decompress=function(n,i,o,a,f,s,h,d,u){if(1==s||f==h.length&&32767!=s)for(var c=0;c<f;c++)h[d+c]=o[a+c];else if(3==s)e.decode._decodeG3(o,a,f,h,d,n.width,u);else if(4==s)e.decode._decodeG4(o,a,f,h,d,n.width,u);else if(5==s)e.decode._decodeLZW(o,a,h,d);else if(6==s)e.decode._decodeOldJPEG(n,o,a,f,h,d);else if(7==s)e.decode._decodeNewJPEG(n,o,a,f,h,d);else if(8==s)for(var l=new Uint8Array(o.buffer,a,f),v=t.inflate(l),g=0;g<v.length;g++)h[d+g]=v[g];else 32767==s?e.decode._decodeARW(n,o,a,f,h,d):32773==s?e.decode._decodePackBits(o,a,f,h,d):32809==s?e.decode._decodeThunder(o,a,f,h,d):34713==s?e.decode._decodeNikon(n,i,o,a,f,h,d):r("Unknown compression",s);var w=n.t258?Math.min(32,n.t258[0]):1,_=n.t277?n.t277[0]:1,p=w*_>>>3,b=n.t278?n.t278[0]:n.height,m=Math.ceil(w*_*n.width/8);if(16==w&&!n.isLE&&null==n.t33422)for(var y=0;y<b;y++)for(var U=d+y*m,E=1;E<m;E+=2){var I=h[U+E];h[U+E]=h[U+E-1],h[U+E-1]=I}if(n.t317&&2==n.t317[0])for(y=0;y<b;y++){var A=d+y*m;if(16==w)for(c=p;c<m;c+=2){var B=(h[A+c+1]<<8|h[A+c])+(h[A+c-p+1]<<8|h[A+c-p]);h[A+c]=255&B,h[A+c+1]=B>>>8&255}else if(3==_)for(c=3;c<m;c+=3)h[A+c]=h[A+c]+h[A+c-3]&255,h[A+c+1]=h[A+c+1]+h[A+c-2]&255,h[A+c+2]=h[A+c+2]+h[A+c-1]&255;else for(c=p;c<m;c++)h[A+c]=h[A+c]+h[A+c-p]&255}},e.decode._ljpeg_diff=function(r,t,n){var i,o,a=e.decode._getbithuff;return i=a(r,t,n[0],n),(o=a(r,t,i,0))&1<<i-1||(o-=(1<<i)-1),o},e.decode._decodeARW=function(r,t,n,i,o,a){var f=r.t256[0],s=r.t257[0],h=r.t258[0],d=r.isLE?e._binLE:e._binBE;if(f*s==i||f*s*1.5==i)if(f*s*1.5!=i){var u,c,l,v,g,w,_,p,b=new Uint16Array(16),m=new Uint8Array(f+1);for(k=0;k<s;k++){for(var y=0;y<f;y++)m[y]=t[n++];for(p=0,D=0;D<f-30;p+=16){for(c=2047&(u=d.readUint(m,p)),l=2047&u>>>11,v=15&u>>>22,g=15&u>>>26,w=0;w<4&&128<<w<=c-l;w++);for(_=30,U=0;U<16;U++)U==v?b[U]=c:U==g?b[U]=l:(b[U]=((d.readUshort(m,p+(_>>3))>>>(7&_)&127)<<w)+l,b[U]>2047&&(b[U]=2047),_+=7);for(U=0;U<16;U++,D+=2){x=b[U]<<1;e.decode._putsF(o,(k*f+D)*h,x<<16-h)}D-=1&D?1:31}}}else for(var U=0;U<i;U+=3){var E=t[n+U+0],I=t[n+U+1],A=t[n+U+2];o[a+U]=I<<4|E>>>4,o[a+U+1]=E<<4|A>>>4,o[a+U+2]=A<<4|I>>>4}else{s+=8;var B,D,k,M=[n,0,0,0],F=new Uint16Array(32770),G=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],N=0,S=e.decode._ljpeg_diff;for(F[0]=15,B=U=0;U<18;U++)for(var P=32768>>>(G[U]>>>8),L=0;L<P;L++)F[++B]=G[U];for(D=f;D--;)for(k=0;k<s+1;k+=2)if(k==s&&(k=1),N+=S(t,M,F),k<s){var x=4095&N;e.decode._putsF(o,(k*f+D)*h,x<<16-h)}}},e.decode._decodeNikon=function(r,t,n,i,o,a,f){var s=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],h=r.t256[0],d=r.t257[0],u=r.t258[0],c=0,l=0,v=e.decode._make_decoder,g=e.decode._getbithuff,w=t[0].exifIFD.makerNote,_=w.t150?w.t150:w.t140,p=0,b=_[p++],m=_[p++];73!=b&&88!=m||(p+=2110),70==b&&(c=2),14==u&&(c+=3);for(var y=[[0,0],[0,0]],U=r.isLE?e._binLE:e._binBE,E=0;E<2;E++)for(var I=0;I<2;I++)y[E][I]=U.readShort(_,p),p+=2;var A,B,D,k,M,F=1<<u&32767,G=0,N=U.readShort(_,p);p+=2,N>1&&(G=Math.floor(F/(N-1))),68==b&&32==m&&G>0&&(l=U.readShort(_,562));var S=[0,0],P=v(s[c]),L=[i,0,0,0];for(A=0;A<d;A++)for(l&&A==l&&(P=v(s[c+1])),B=0;B<h;B++){E=g(n,L,P[0],P),(M=1+(g(n,L,(D=15&E)-(k=E>>>4),0)<<1)<<k>>>1)&1<<D-1||(M-=(1<<D)-(0==k?1:0)),B<2?S[B]=y[1&A][B]+=M:S[1&B]+=M;var x=Math.min(Math.max(S[1&B],0),(1<<u)-1),J=(A*h+B)*u;e.decode._putsF(a,J,x<<16-u)}},e.decode._putsF=function(e,r,t){t<<=8-(7&r);var n=r>>>3;e[n]|=t>>>16,e[n+1]|=t>>>8,e[n+2]|=t},e.decode._getbithuff=function(r,t,n,i){e.decode._get_byte;var o,a=t[0],f=t[1],s=t[2],h=t[3];if(0==n||s<0)return 0;for(;!h&&s<n&&-1!=(o=r[a++])&&!(h=0);)f=(f<<8)+o,s+=8;if(o=f<<32-s>>>32-n,i?(s-=i[o+1]>>>8,o=255&i[o+1]):s-=n,s<0)throw"e";return t[0]=a,t[1]=f,t[2]=s,t[3]=h,o},e.decode._make_decoder=function(e){var r,t,n,i,o,a=[];for(r=16;0!=r&&!e[r];r--);var f=17;for(a[0]=r,n=t=1;t<=r;t++)for(i=0;i<e[t];i++,++f)for(o=0;o<1<<r-t;o++)n<=1<<r&&(a[n++]=t<<8|e[f]);return a},e.decode._decodeNewJPEG=function(r,t,n,i,o,a){var f=r.t347,s=f?f.length:0,h=new Uint8Array(s+i);if(f){for(var d=0,u=0;u<s-1&&(255!=f[u]||217!=f[u+1]);u++)h[d++]=f[u];var c=t[n],l=t[n+1];255==c&&216==l||(h[d++]=c,h[d++]=l);for(u=2;u<i;u++)h[d++]=t[n+u]}else for(u=0;u<i;u++)h[u]=t[n+u];if(32803==r.t262[0]||34892==r.t262[0]){var v=r.t258[0],g=e.LosslessJpegDecode(h),w=g.length;if(16==v)if(r.isLE)for(u=0;u<w;u++)o[a+(u<<1)]=255&g[u],o[a+(u<<1)+1]=g[u]>>>8;else for(u=0;u<w;u++)o[a+(u<<1)]=g[u]>>>8,o[a+(u<<1)+1]=255&g[u];else{if(14!=v&&12!=v)throw new Error("unsupported bit depth "+v);var _=16-v;for(u=0;u<w;u++)e.decode._putsF(o,u*v,g[u]<<_)}}else{var p=new e.JpegDecoder;p.parse(h);var b=p.getData(p.width,p.height);for(u=0;u<b.length;u++)o[a+u]=b[u]}6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodeOldJPEGInit=function(e,t,n,i){var o,a,f,s,h,d=216,u=0,c=0,l=!1,v=e.t513,g=v?v[0]:0,w=e.t514,_=w?w[0]:0,p=e.t324||e.t273||v,b=e.t530,m=0,y=0,U=e.t277?e.t277[0]:1,E=e.t515;if(p&&(c=p[0],l=p.length>1),!l){if(255==t[n]&&t[n+1]==d)return{jpegOffset:n};if(null!=v&&(255==t[n+g]&&t[n+g+1]==d?u=n+g:r("JPEGInterchangeFormat does not point to SOI"),null==w?r("JPEGInterchangeFormatLength field is missing"):(g>=c||g+_<=c)&&r("JPEGInterchangeFormatLength field value is invalid"),null!=u))return{jpegOffset:u}}if(null!=b&&(m=b[0],y=b[1]),null!=v&&null!=w)if(_>=2&&g+_<=c){for(o=255==t[n+g+_-2]&&t[n+g+_-1]==d?new Uint8Array(_-2):new Uint8Array(_),f=0;f<o.length;f++)o[f]=t[n+g+f];r("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else r("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(null==o){var I=0,A=[];A[I++]=255,A[I++]=d;var B=e.t519;if(null==B)throw new Error("JPEGQTables tag is missing");for(f=0;f<B.length;f++)for(A[I++]=255,A[I++]=219,A[I++]=0,A[I++]=67,A[I++]=f,s=0;s<64;s++)A[I++]=t[n+B[f]+s];for(h=0;h<2;h++){var D=e[0==h?"t520":"t521"];if(null==D)throw new Error((0==h?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(f=0;f<D.length;f++){A[I++]=255,A[I++]=196;var k=19;for(s=0;s<16;s++)k+=t[n+D[f]+s];for(A[I++]=k>>>8,A[I++]=255&k,A[I++]=f|h<<4,s=0;s<16;s++)A[I++]=t[n+D[f]+s];for(s=0;s<k;s++)A[I++]=t[n+D[f]+16+s]}}if(A[I++]=255,A[I++]=192,A[I++]=0,A[I++]=8+3*U,A[I++]=8,A[I++]=e.height>>>8&255,A[I++]=255&e.height,A[I++]=e.width>>>8&255,A[I++]=255&e.width,A[I++]=U,1==U)A[I++]=1,A[I++]=17,A[I++]=0;else for(f=0;f<3;f++)A[I++]=f+1,A[I++]=0!=f?17:(15&m)<<4|15&y,A[I++]=f;null!=E&&0!=E[0]&&(A[I++]=255,A[I++]=221,A[I++]=0,A[I++]=4,A[I++]=E[0]>>>8&255,A[I++]=255&E[0]),o=new Uint8Array(A)}var M=-1;for(f=0;f<o.length-1;){if(255==o[f]&&192==o[f+1]){M=f;break}f++}if(-1==M){var F=new Uint8Array(o.length+10+3*U);F.set(o);var G=o.length;if(M=o.length,(o=F)[G++]=255,o[G++]=192,o[G++]=0,o[G++]=8+3*U,o[G++]=8,o[G++]=e.height>>>8&255,o[G++]=255&e.height,o[G++]=e.width>>>8&255,o[G++]=255&e.width,o[G++]=U,1==U)o[G++]=1,o[G++]=17,o[G++]=0;else for(f=0;f<3;f++)o[G++]=f+1,o[G++]=0!=f?17:(15&m)<<4|15&y,o[G++]=f}if(255==t[c]&&218==t[c+1]){var N=t[c+2]<<8|t[c+3];for((a=new Uint8Array(N+2))[0]=t[c],a[1]=t[c+1],a[2]=t[c+2],a[3]=t[c+3],f=0;f<N-2;f++)a[f+4]=t[c+f+4]}else{var S=0;if((a=new Uint8Array(8+2*U))[S++]=255,a[S++]=218,a[S++]=0,a[S++]=6+2*U,a[S++]=U,1==U)a[S++]=1,a[S++]=0;else for(f=0;f<3;f++)a[S++]=f+1,a[S++]=f<<4|f;a[S++]=0,a[S++]=63,a[S++]=0}return{jpegOffset:n,tables:o,sosMarker:a,sofPosition:M}},e.decode._decodeOldJPEG=function(r,t,n,i,o,a){var f,s,h,d,u=e.decode._decodeOldJPEGInit(r,t,n,i);if(null!=u.jpegOffset)for(f=n+i-u.jpegOffset,h=new Uint8Array(f),v=0;v<f;v++)h[v]=t[u.jpegOffset+v];else{for(s=u.tables.length,(h=new Uint8Array(s+u.sosMarker.length+i+2)).set(u.tables),d=s,h[u.sofPosition+5]=r.height>>>8&255,h[u.sofPosition+6]=255&r.height,h[u.sofPosition+7]=r.width>>>8&255,h[u.sofPosition+8]=255&r.width,255==t[n]&&t[n+1]==SOS||(h.set(u.sosMarker,d),d+=sosMarker.length),v=0;v<i;v++)h[d++]=t[n+v];h[d++]=255,h[d++]=EOI}var c=new e.JpegDecoder;c.parse(h);for(var l=c.getData(c.width,c.height),v=0;v<l.length;v++)o[a+v]=l[v];r.t262&&6==r.t262[0]&&(r.t262[0]=2)},e.decode._decodePackBits=function(e,r,t,n,i){for(var o=new Int8Array(e.buffer),a=new Int8Array(n.buffer),f=r+t;r<f;){var s=o[r];if(r++,s>=0&&s<128)for(var h=0;h<s+1;h++)a[i]=o[r],i++,r++;if(s>=-127&&s<0){for(h=0;h<1-s;h++)a[i]=o[r],i++;r++}}},e.decode._decodeThunder=function(e,r,t,n,i){for(var o=[0,1,0,-1],a=[0,1,2,3,0,-3,-2,-1],f=r+t,s=2*i,h=0;r<f;){var d=e[r],u=d>>>6,c=63&d;if(r++,3==u&&(h=15&c,n[s>>>1]|=h<<4*(1-s&1),s++),0==u)for(var l=0;l<c;l++)n[s>>>1]|=h<<4*(1-s&1),s++;if(2==u)for(l=0;l<2;l++){4!=(v=c>>>3*(1-l)&7)&&(h+=a[v],n[s>>>1]|=h<<4*(1-s&1),s++)}if(1==u)for(l=0;l<3;l++){var v;2!=(v=c>>>2*(2-l)&3)&&(h+=o[v],n[s>>>1]|=h<<4*(1-s&1),s++)}}},e.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},e.decode._lens=function(){var e=function(e,r,t,n){for(var i=0;i<r.length;i++)e[r[i]]=t+i*n},r="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",t="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",n="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",i="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",o="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";r=r.split(","),t=t.split(","),n=n.split(","),i=i.split(","),o=o.split(",");var a={},f={};return e(a,r,0,1),e(a,n,64,64),e(a,o,1792,64),e(f,t,0,1),e(f,i,64,64),e(f,o,1792,64),[a,f]}(),e.decode._decodeG4=function(r,t,n,i,o,a,f){for(var s=e.decode,h=t<<3,d=0,u="",c=[],l=[],v=0;v<a;v++)l.push(0);l=s._makeDiff(l);for(var g=0,w=0,_=0,p=0,b=0,m=0,y="",U=0,E=8*Math.ceil(a/8);h>>>3<t+n;){_=s._findDiff(l,g+(0==g?0:1),1-b),p=s._findDiff(l,_,b);var I=0;if(1==f&&(I=r[h>>>3]>>>7-(7&h)&1),2==f&&(I=r[h>>>3]>>>(7&h)&1),h++,u+=I,"H"==y){if(null!=s._lens[b][u]){var A=s._lens[b][u];u="",d+=A,A<64&&(s._addNtimes(c,d,b),g+=d,b=1-b,d=0,0==--U&&(y=""))}}else"0001"==u&&(u="",s._addNtimes(c,p-g,b),g=p),"001"==u&&(u="",y="H",U=2),null!=s._dmap[u]&&(w=_+s._dmap[u],s._addNtimes(c,w-g,b),g=w,u="",b=1-b);c.length==a&&""==y&&(s._writeBits(c,i,8*o+m*E),b=0,m++,g=0,l=s._makeDiff(c),c=[])}},e.decode._findDiff=function(e,r,t){for(var n=0;n<e.length;n+=2)if(e[n]>=r&&e[n+1]==t)return e[n]},e.decode._makeDiff=function(e){var r=[];1==e[0]&&r.push(0,1);for(var t=1;t<e.length;t++)e[t-1]!=e[t]&&r.push(t,e[t]);return r.push(e.length,0,e.length,1),r},e.decode._decodeG3=function(r,t,n,i,o,a,f){for(var s=e.decode,h=t<<3,d=0,u="",c=[],l=[],v=0;v<a;v++)c.push(0);for(var g=0,w=0,_=0,p=0,b=0,m=-1,y="",U=0,E=!1,I=8*Math.ceil(a/8);h>>>3<t+n;){_=s._findDiff(l,g+(0==g?0:1),1-b),p=s._findDiff(l,_,b);var A=0;if(1==f&&(A=r[h>>>3]>>>7-(7&h)&1),2==f&&(A=r[h>>>3]>>>(7&h)&1),h++,u+=A,E){if(null!=s._lens[b][u]){var B=s._lens[b][u];u="",d+=B,B<64&&(s._addNtimes(c,d,b),b=1-b,d=0)}}else if("H"==y){if(null!=s._lens[b][u]){B=s._lens[b][u];u="",d+=B,B<64&&(s._addNtimes(c,d,b),g+=d,b=1-b,d=0,0==--U&&(y=""))}}else"0001"==u&&(u="",s._addNtimes(c,p-g,b),g=p),"001"==u&&(u="",y="H",U=2),null!=s._dmap[u]&&(w=_+s._dmap[u],s._addNtimes(c,w-g,b),g=w,u="",b=1-b);u.endsWith("000000000001")&&(m>=0&&s._writeBits(c,i,8*o+m*I),1==f&&(E=1==(r[h>>>3]>>>7-(7&h)&1)),2==f&&(E=1==(r[h>>>3]>>>(7&h)&1)),h++,null==s._decodeG3.allow2D&&(s._decodeG3.allow2D=E),s._decodeG3.allow2D||(E=!0,h--),u="",b=0,m++,g=0,l=s._makeDiff(c),c=[])}c.length==a&&s._writeBits(c,i,8*o+m*I)},e.decode._addNtimes=function(e,r,t){for(var n=0;n<r;n++)e.push(t)},e.decode._writeBits=function(e,r,t){for(var n=0;n<e.length;n++)r[t+n>>>3]|=e[n]<<7-(t+n&7)},e.decode._decodeLZW=function(r,t,n,i){if(null==e.decode._lzwTab){for(var o=new Uint32Array(65535),a=new Uint16Array(65535),f=new Uint8Array(2e6),s=0;s<256;s++)f[s<<2]=s,o[s]=s<<2,a[s]=1;e.decode._lzwTab=[o,a,f]}for(var h=e.decode._copyData,d=e.decode._lzwTab[0],u=e.decode._lzwTab[1],c=(f=e.decode._lzwTab[2],258),l=1032,v=9,g=t<<3,w=0,_=0;w=(r[g>>>3]<<16|r[g+8>>>3]<<8|r[g+16>>>3])>>24-(7&g)-v&(1<<v)-1,g+=v,257!=w;){if(256==w){if(v=9,c=258,l=1032,w=(r[g>>>3]<<16|r[g+8>>>3]<<8|r[g+16>>>3])>>24-(7&g)-v&(1<<v)-1,g+=v,257==w)break;n[i]=w,i++}else if(w<c){var p=d[w],b=u[w];if(h(f,p,n,i,b),i+=b,_>=c)d[c]=l,f[d[c]]=p[0],u[c]=1,l=l+1+3&-4,c++;else d[c]=l,h(f,d[_],f,l,m=u[_]),f[l+m]=f[p],m++,u[c]=m,c++,l=l+m+3&-4;c+1==1<<v&&v++}else{var m;if(_>=c)d[c]=l,u[c]=0,c++;else d[c]=l,h(f,d[_],f,l,m=u[_]),f[l+m]=f[l],m++,u[c]=m,c++,h(f,l,n,i,m),i+=m,l=l+m+3&-4;c+1==1<<v&&v++}_=w}},e.decode._copyData=function(e,r,t,n,i){for(var o=0;o<i;o+=4)t[n+o]=e[r+o],t[n+o+1]=e[r+o+1],t[n+o+2]=e[r+o+2],t[n+o+3]=e[r+o+3]},e.tags={},e.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},e._readIFD=function(t,n,i,o,a,f){var s=t.readUshort(n,i);i+=2;var h={};o.push(h),f&&r("   ".repeat(a),o.length-1,">>>----------------");for(var d=0;d<s;d++){var u=t.readUshort(n,i);i+=2;var c=t.readUshort(n,i);i+=2;var l=t.readUint(n,i);i+=4;var v=t.readUint(n,i);i+=4;var g=[];if(1!=c&&7!=c||(g=new Uint8Array(n.buffer,l<5?i-4:v,l)),2==c){var w=l<5?i-4:v;n[w]<128?g.push(t.readASCII(n,w,l-1)):g=new Uint8Array(n.buffer,w,l-1)}if(3==c)for(var _=0;_<l;_++)g.push(t.readUshort(n,(l<3?i-4:v)+2*_));if(4==c)for(_=0;_<l;_++)g.push(t.readUint(n,(l<2?i-4:v)+4*_));if(5==c)for(_=0;_<l;_++)g.push(t.readUint(n,v+8*_)/t.readUint(n,v+8*_+4));if(8==c)for(_=0;_<l;_++)g.push(t.readShort(n,(l<3?i-4:v)+2*_));if(9==c)for(_=0;_<l;_++)g.push(t.readInt(n,(l<2?i-4:v)+4*_));if(10==c)for(_=0;_<l;_++)g.push(t.readInt(n,v+8*_)/t.readInt(n,v+8*_+4));if(11==c)for(_=0;_<l;_++)g.push(t.readFloat(n,v+4*_));if(12==c)for(_=0;_<l;_++)g.push(t.readDouble(n,v+8*_));if(h["t"+u]=g,0!=l&&0==g.length&&r("unknown TIFF tag type: ",c,"num:",l),f&&r("   ".repeat(a),u,c,e.tags[u],g),330==u&&h.t272&&"DSLR-A100"==h.t272[0]);else if(330==u||34665==u||50740==u&&t.readUshort(n,t.readUint(g,0))<300){var p=50740==u?[t.readUint(g,0)]:g,b=[];for(_=0;_<p.length;_++)e._readIFD(t,n,p[_],b,a+1,f);330==u&&(h.subIFD=b),34665==u&&(h.exifIFD=b[0]),50740==u&&(h.dngPrvt=b[0])}if(37500==u){var m=g;if("Nikon"==t.readASCII(m,0,5))h.makerNote=e.decode(m.slice(10).buffer)[0];else if(t.readUshort(n,v)<300){var y=[];e._readIFD(t,n,v,y,a+1,f),h.makerNote=y[0]}}}return f&&r("   ".repeat(a),"<<<---------------"),i},e._writeIFD=function(r,t,n,i){var o=Object.keys(i);r.writeUshort(t,n,o.length);for(var a=(n+=2)+12*o.length+4,f=0;f<o.length;f++){var s=o[f],h=parseInt(s.slice(1)),d=e.ttypes[h];if(null==d)throw new Error("unknown type of tag: "+h);var u=i[s];2==d&&(u=u[0]+"\0");var c=u.length;r.writeUshort(t,n,h),n+=2,r.writeUshort(t,n,d),n+=2,r.writeUint(t,n,c);var l=[-1,1,1,2,4,8,0,0,0,0,0,0,8][d]*c,v=n+=4;if(l>4&&(r.writeUint(t,n,a),v=a),2==d&&r.writeASCII(t,v,u),3==d)for(var g=0;g<c;g++)r.writeUshort(t,v+2*g,u[g]);if(4==d)for(g=0;g<c;g++)r.writeUint(t,v+4*g,u[g]);if(5==d)for(g=0;g<c;g++)r.writeUint(t,v+8*g,Math.round(1e4*u[g])),r.writeUint(t,v+8*g+4,1e4);if(12==d)for(g=0;g<c;g++)r.writeDouble(t,v+8*g,u[g]);l>4&&(a+=l+=1&l),n+=4}return[n,a]},e.toRGBA8=function(e){var t=e.width,n=e.height,i=t*n,o=4*i,a=e.data,f=new Uint8Array(4*i),s=e.t262?e.t262[0]:2,h=e.t258?Math.min(32,e.t258[0]):1;if(0==s)for(var d=Math.ceil(h*t/8),u=0;u<n;u++){var c=u*d,l=u*t;if(1==h)for(var v=0;v<t;v++){var g=l+v<<2,w=a[c+(v>>3)]>>7-(7&v)&1;f[g]=f[g+1]=f[g+2]=255*(1-w),f[g+3]=255}if(4==h)for(v=0;v<t;v++){g=l+v<<2,w=a[c+(v>>1)]>>4-4*(1&v)&15;f[g]=f[g+1]=f[g+2]=17*(15-w),f[g+3]=255}if(8==h)for(v=0;v<t;v++){g=l+v<<2,w=a[c+v];f[g]=f[g+1]=f[g+2]=255-w,f[g+3]=255}}else if(1==s)for(d=Math.ceil(h*t/8),u=0;u<n;u++){c=u*d,l=u*t;if(1==h)for(v=0;v<t;v++){g=l+v<<2,w=a[c+(v>>3)]>>7-(7&v)&1;f[g]=f[g+1]=f[g+2]=255*w,f[g+3]=255}if(2==h)for(v=0;v<t;v++){g=l+v<<2,w=a[c+(v>>2)]>>6-2*(3&v)&3;f[g]=f[g+1]=f[g+2]=85*w,f[g+3]=255}if(8==h)for(v=0;v<t;v++){g=l+v<<2,w=a[c+v];f[g]=f[g+1]=f[g+2]=w,f[g+3]=255}if(16==h)for(v=0;v<t;v++){g=l+v<<2,w=a[c+(2*v+1)];f[g]=f[g+1]=f[g+2]=Math.min(255,w),f[g+3]=255}}else if(2==s){var _=e.t258?e.t258.length:3;if(8==h){if(4==_)for(v=0;v<o;v++)f[v]=a[v];if(3==_)for(v=0;v<i;v++){var p=3*v;f[g=v<<2]=a[p],f[g+1]=a[p+1],f[g+2]=a[p+2],f[g+3]=255}}else{if(4==_)for(v=0;v<i;v++){p=8*v+1;f[g=v<<2]=a[p],f[g+1]=a[p+2],f[g+2]=a[p+4],f[g+3]=a[p+6]}if(3==_)for(v=0;v<i;v++){p=6*v+1;f[g=v<<2]=a[p],f[g+1]=a[p+2],f[g+2]=a[p+4],f[g+3]=255}}}else if(3==s){var b=e.t320;for(v=0;v<i;v++){g=v<<2;var m=a[v];f[g]=b[m]>>8,f[g+1]=b[256+m]>>8,f[g+2]=b[512+m]>>8,f[g+3]=255}}else if(5==s){var y=(_=e.t258?e.t258.length:4)>4?1:0;for(v=0;v<i;v++){g=v<<2;var U=v*_,E=255-a[U],I=255-a[U+1],A=255-a[U+2],B=(255-a[U+3])*(1/255);f[g]=~~(E*B+.5),f[g+1]=~~(I*B+.5),f[g+2]=~~(A*B+.5),f[g+3]=255*(1-y)+a[U+4]*y}}else r("Unknown Photometric interpretation: "+s);return f},e.replaceIMG=function(r){null==r&&(r=document.getElementsByTagName("img"));for(var t=["tif","tiff","dng","cr2","nef"],n=0;n<r.length;n++){var i=r[n],o=i.getAttribute("src");if(null!=o){var a=o.split(".").pop().toLowerCase();if(-1!=t.indexOf(a)){var f=new XMLHttpRequest;e._xhrs.push(f),e._imgs.push(i),f.open("GET",o),f.responseType="arraybuffer",f.onload=e._imgLoaded,f.send()}}}},e._xhrs=[],e._imgs=[],e._imgLoaded=function(r){var t=r.target.response,n=e.decode(t),i=n,o=0,a=i[0];n[0].subIFD&&(i=i.concat(n[0].subIFD));for(var f=0;f<i.length;f++){if(!(null==(l=i[f]).t258||l.t258.length<3)){var s=l.t256*l.t257;s>o&&(o=s,a=l)}}e.decodeImage(t,a,n);var h=e.toRGBA8(a),d=a.width,u=a.height,c=e._xhrs.indexOf(r.target),l=e._imgs[c];e._xhrs.splice(c,1),e._imgs.splice(c,1);var v=document.createElement("canvas");v.width=d,v.height=u;var g=v.getContext("2d"),w=g.createImageData(d,u);for(f=0;f<h.length;f++)w.data[f]=h[f];g.putImageData(w,0,0),l.setAttribute("src",v.toDataURL())},e._binBE={nextZero:function(e,r){for(;0!=e[r];)r++;return r},readUshort:function(e,r){return e[r]<<8|e[r+1]},readShort:function(r,t){var n=e._binBE.ui8;return n[0]=r[t+1],n[1]=r[t+0],e._binBE.i16[0]},readInt:function(r,t){var n=e._binBE.ui8;return n[0]=r[t+3],n[1]=r[t+2],n[2]=r[t+1],n[3]=r[t+0],e._binBE.i32[0]},readUint:function(r,t){var n=e._binBE.ui8;return n[0]=r[t+3],n[1]=r[t+2],n[2]=r[t+1],n[3]=r[t+0],e._binBE.ui32[0]},readASCII:function(e,r,t){for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[r+i]);return n},readFloat:function(r,t){for(var n=e._binBE.ui8,i=0;i<4;i++)n[i]=r[t+3-i];return e._binBE.fl32[0]},readDouble:function(r,t){for(var n=e._binBE.ui8,i=0;i<8;i++)n[i]=r[t+7-i];return e._binBE.fl64[0]},writeUshort:function(e,r,t){e[r]=t>>8&255,e[r+1]=255&t},writeUint:function(e,r,t){e[r]=t>>24&255,e[r+1]=t>>16&255,e[r+2]=t>>8&255,e[r+3]=255&t},writeASCII:function(e,r,t){for(var n=0;n<t.length;n++)e[r+n]=t.charCodeAt(n)},writeDouble:function(r,t,n){e._binBE.fl64[0]=n;for(var i=0;i<8;i++)r[t+i]=e._binBE.ui8[7-i]}},e._binBE.ui8=new Uint8Array(8),e._binBE.i16=new Int16Array(e._binBE.ui8.buffer),e._binBE.i32=new Int32Array(e._binBE.ui8.buffer),e._binBE.ui32=new Uint32Array(e._binBE.ui8.buffer),e._binBE.fl32=new Float32Array(e._binBE.ui8.buffer),e._binBE.fl64=new Float64Array(e._binBE.ui8.buffer),e._binLE={nextZero:e._binBE.nextZero,readUshort:function(e,r){return e[r+1]<<8|e[r]},readShort:function(r,t){var n=e._binBE.ui8;return n[0]=r[t+0],n[1]=r[t+1],e._binBE.i16[0]},readInt:function(r,t){var n=e._binBE.ui8;return n[0]=r[t+0],n[1]=r[t+1],n[2]=r[t+2],n[3]=r[t+3],e._binBE.i32[0]},readUint:function(r,t){var n=e._binBE.ui8;return n[0]=r[t+0],n[1]=r[t+1],n[2]=r[t+2],n[3]=r[t+3],e._binBE.ui32[0]},readASCII:e._binBE.readASCII,readFloat:function(r,t){for(var n=e._binBE.ui8,i=0;i<4;i++)n[i]=r[t+i];return e._binBE.fl32[0]},readDouble:function(r,t){for(var n=e._binBE.ui8,i=0;i<8;i++)n[i]=r[t+i];return e._binBE.fl64[0]}},e._copyTile=function(e,r,t,n,i,o,a,f){for(var s=Math.min(r,i-a),h=Math.min(t,o-f),d=0;d<h;d++)for(var u=(f+d)*i+a,c=d*r,l=0;l<s;l++)n[u+l]=e[c+l]},e.LosslessJpegDecode=function(){function e(e){this.w=e,this.N=0,this._=0,this.G=0}e.prototype={t:function(e){this.N=Math.max(0,Math.min(this.w.length,e))},i:function(){return this.w[this.N++]},l:function(){var e=this.N;return this.N+=2,this.w[e]<<8|this.w[e+1]},J:function(){return 0==this._&&(this.G=this.w[this.N],this.N+=1+(this.G+1>>>8),this._=8),this.G>>>--this._&1},Z:function(e){var r=this._,t=this.G,n=Math.min(r,e);e-=n;for(var i=t>>>(r-=n)&(1<<n)-1;e>0;)t=this.w[this.N],this.N+=1+(t+1>>>8),e-=n=Math.min(8,e),i<<=n,i|=t>>>(r=8-n)&(1<<n)-1;return this._=r,this.G=t,i}};var r={};function t(r){this.z=new e(r),this.D(this.z)}return r.X=function(){return[0,0,-1]},r.s=function(e,t,n){e[r.Y(e,0,n)+2]=t},r.Y=function(e,t,n){if(-1!=e[t+2])return 0;if(0==n)return t;for(var i=0;i<2;i++){0==e[t+i]&&(e[t+i]=e.length,e.push(0),e.push(0),e.push(-1));var o=r.Y(e,e[t+i],n-1);if(0!=o)return o}return 0},r.B=function(e,r){for(var t=0,n=0,i=r._,o=r.G,a=r.N;;)if(0==i&&(a+=1+((o=r.w[a])+1>>>8),i=8),-1!=(n=e[(t=e[t+(o>>>--i&1)])+2]))return r._=i,r.G=o,r.N=a,n;return-1},t.prototype={$:function(e,r){this.Q=e.i(),this.F=e.l(),this.o=e.l();var t=this.O=e.i();this.L=[];for(var n=0;n<t;n++){var i=e.i();e.i();e.i(),this.L[i]=n}e.t(e.N+r-(6+3*t))},e:function(){var e=0,t=this.z.i();null==this.H&&(this.H={});for(var n=this.H[t]=r.X(),i=[],o=0;o<16;o++)i[o]=this.z.i(),e+=i[o];for(o=0;o<16;o++)for(var a=0;a<i[o];a++)r.s(n,this.z.i(),o+1);return e+17},W:function(e){for(;e>0;)e-=this.e()},p:function(e,r){var t=e.i();this.U||(this.U=[]);for(var n=0;n<t;n++){var i=e.i(),o=e.i();this.U[this.L[i]]=this.H[o>>>4]}this.g=e.i(),e.t(e.N+r-(2+2*t))},D:function(e){var r=!1;if((n=e.l())===t.q)do{var n=e.l(),i=e.l()-2;switch(n){case t.m:this.$(e,i);break;case t.K:this.W(i);break;case t.V:this.p(e,i),r=!0;break;default:e.t(e.N+i)}}while(!r)},I:function(e,t){var n=r.B(t,e);if(16==n)return-32768;var i=e.Z(n);return i&1<<n-1||(i-=(1<<n)-1),i},B:function(e,r){for(var t=this.z,n=this.O,i=this.F,o=this.I,a=this.g,f=this.o*n,s=this.U,h=0;h<n;h++)e[h]=o(t,s[h])+(1<<this.Q-1);for(var d=n;d<f;d+=n)for(h=0;h<n;h++)e[d+h]=o(t,s[h])+e[d+h-n];for(var u=r,c=1;c<i;c++){for(h=0;h<n;h++)e[u+h]=o(t,s[h])+e[u+h-r];for(d=n;d<f;d+=n)for(h=0;h<n;h++){var l=u+d+h,v=e[l-n];6==a&&(v=e[l-r]+(v-e[l-n-r]>>>1)),e[l]=v+o(t,s[h])}u+=r}}},t.m=65475,t.K=65476,t.q=65496,t.V=65498,function(e){var r=new t(e),n=new(r.Q>8?Uint16Array:Uint8Array)(r.o*r.F*r.O),i=r.o*r.O;return r.B(n,i),n}}()}(e,"function"==typeof require?require("pako"):self.pako)}();
//# sourceMappingURL=/sm/2e39ea5b7b630a4077c9cc34fbb99ed4dfe44c1d0aa7f1483c8a04556f1534a3.map